(()=>{var t={20:(t,e,n)=>{"use strict";var s=n(677),o=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,n){var s,r={},c=null,u=null;for(s in void 0!==n&&(c=""+n),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(u=e.ref),e)i.call(e,s)&&!l.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps)void 0===r[s]&&(r[s]=e[s]);return{$$typeof:o,type:t,key:c,ref:u,props:r,_owner:a.current}}e.Fragment=r,e.jsx=c,e.jsxs=c},848:(t,e,n)=>{"use strict";t.exports=n(20)},677:t=>{t.exports=function(){return this.React}()},419:t=>{t.exports=function(){return this.lodash}()},631:t=>{t.exports=function(){return this.wp.apiFetch}()},959:t=>{t.exports=function(){return this.wp.components}()},897:t=>{t.exports=function(){return this.wp.compose}()},488:t=>{t.exports=function(){return this.wp.coreData}()},987:t=>{t.exports=function(){return this.wp.data}()},53:t=>{t.exports=function(){return this.wp.editPost}()},601:t=>{t.exports=function(){return this.wp.element}()},75:t=>{t.exports=function(){return this.wp.i18n}()},860:t=>{t.exports=function(){return this.wp.keycodes}()},672:t=>{t.exports=function(){return this.wp.notices}()},125:t=>{t.exports=function(){return this.wp.plugins}()},933:t=>{t.exports=function(){return this.wp.primitives}()},172:t=>{t.exports=function(){return this.wp.url}()},942:(t,e)=>{var n;!function(){"use strict";var s={}.hasOwnProperty;function o(){for(var t="",e=0;e<arguments.length;e++){var n=arguments[e];n&&(t=i(t,r(n)))}return t}function r(t){if("string"==typeof t||"number"==typeof t)return t;if("object"!=typeof t)return"";if(Array.isArray(t))return o.apply(null,t);if(t.toString!==Object.prototype.toString&&!t.toString.toString().includes("[native code]"))return t.toString();var e="";for(var n in t)s.call(t,n)&&t[n]&&(e=i(e,n));return e}function i(t,e){return e?t?t+" "+e:t+e:t}t.exports?(o.default=o,t.exports=o):void 0===(n=function(){return o}.apply(e,[]))||(t.exports=n)}()}},e={};function n(s){var o=e[s];if(void 0!==o)return o.exports;var r=e[s]={exports:{}};return t[s](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);(()=>{"use strict";var t=n(53),e=n(125),s=n(933),o=n(848);const r=void 0!==wp.primitives?(0,o.jsx)(s.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,o.jsx)(s.Path,{d:"M6 15v-13h10v13h-10zM5 16h8v2h-10v-13h2v11z"})}):"admin-page",i=void 0!==wp.primitives?(0,o.jsx)(s.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,o.jsx)(s.Path,{d:"M13.89 3.39l2.71 2.72c0.46 0.46 0.42 1.24 0.030 1.64l-8.010 8.020-5.56 1.16 1.16-5.58s7.6-7.63 7.99-8.030c0.39-0.39 1.22-0.39 1.68 0.070zM11.16 6.18l-5.59 5.61 1.11 1.11 5.54-5.65zM8.19 14.41l5.58-5.6-1.070-1.080-5.59 5.6z"})}):"edit",a=void 0!==wp.primitive?(0,o.jsx)(s.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,o.jsx)(s.Path,{d:"M17 7v3h-5v5h-3v-5h-5v-3h5v-5h3v5h5z"})}):"plus",l=void 0!==wp.primitives?(0,o.jsx)(s.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,o.jsx)(s.Path,{d:"M5 7v3l-2 1.5v-6.5h11v-2l4 3.010-4 2.99v-2h-9zM15 13v-3l2-1.5v6.5h-11v2l-4-3.010 4-2.99v2h9z"})}):"controls-repeat",c=void 0!==wp.primitives?(0,o.jsx)(s.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,o.jsx)(s.Path,{d:"M11 7H9.49c-.63 0-1.25.3-1.59.7L7 5H4.13l-2.39 7h1.69l.74-2H7v4H2c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h7c1.1 0 2 .9 2 2v2zM6.51 9H4.49l1-2.93zM10 8h7c1.1 0 2 .9 2 2v7c0 1.1-.9 2-2 2h-7c-1.1 0-2-.9-2-2v-7c0-1.1.9-2 2-2zm7.25 5v-1.08h-3.17V9.75h-1.16v2.17H9.75V13h1.28c.11.85.56 1.85 1.28 2.62-.87.36-1.89.62-2.31.62-.01.02.22.97.2 1.46.84 0 2.21-.5 3.28-1.15 1.09.65 2.48 1.15 3.34 1.15-.02-.49.2-1.44.2-1.46-.43 0-1.49-.27-2.38-.63.7-.77 1.14-1.77 1.25-2.61h1.36zm-3.81 1.93c-.5-.46-.85-1.13-1.01-1.93h2.09c-.17.8-.51 1.47-1 1.93l-.04.03s-.03-.02-.04-.03z"})}):"translation";void 0!==wp.primitives&&(s.SVG,s.Path),void 0!==wp.primitives&&(s.SVG,s.Path),wp.primitives;var u=n(959),p=n(75);const d=({sidebar:t,sidebarName:n,onPromise:s,children:r})=>(s().then((()=>{(0,e.registerPlugin)(n,{icon:c,render:t})}),(t=>{console.info(t)})),(0,o.jsx)(o.Fragment,{children:r}));var g=n(987),h=n(672);const{stripTags:f}=wp.sanitize,m=({notices:t})=>{const{createErrorNotice:e,createInfoNotice:n,createSuccessNotice:s,createWarningNotice:o}=(0,g.useDispatch)(h.store);return t?(t.forEach((t=>{const r={type:"snackbar",explicitDismiss:!0},i=f(t.message);switch(t.type){case"error":e(i,r);break;case"info":n(i,r);break;case"success":s(i,r);break;case"warning":o(i,r)}})),null):null},_=({SidebarSlot:t,MoreMenuItemSlot:e,sidebarName:n,children:s})=>{const r=(0,p.__)("Languages","polylang-pro");return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t,{name:n,title:r,children:s}),(0,o.jsx)(e,{target:n,children:r})]})};var y=n(601),v=n(172),b=n(419);const w=function({language:t}){return(0,b.isNil)(t)?(0,o.jsx)("span",{className:"pll-translation-icon",children:c}):(0,b.isEmpty)(t.flag_url)?(0,o.jsxs)("abbr",{children:[t.slug,(0,o.jsx)("span",{className:"screen-reader-text",children:t.name})]}):(0,o.jsx)("span",{className:"pll-select-flag",children:(0,o.jsx)("img",{src:t.flag_url,alt:t.name,title:t.name,className:"flag"})})};function x({handleChange:t,children:e,selectedLanguage:n=null,defaultValue:s=""}){const r=n?.slug?n.slug:s;return(0,o.jsxs)("div",{id:"select-post-language",children:[(0,o.jsx)(w,{language:n}),e&&(0,o.jsx)("select",{value:r,onChange:e=>t(e),id:"pll_post_lang_choice",name:"pll_post_lang_choice",className:"post_lang_choice",children:e})]})}function P({languages:t}){return Array.from(t.values()).map((({slug:t,name:e,w3c:n})=>(0,o.jsx)("option",{value:t,lang:n,children:e},t)))}const j="pll/metabox",S="core/editor",E="core/edit-site",C="core",T={languages:[],selectedLanguage:{},translatedPosts:{},fromPost:null,currentTemplatePart:{}},N=["wp_template","wp_global_styles"],L=({children:t})=>(0,o.jsx)("div",{className:"components-panel__body is-opened",children:(0,o.jsx)("div",{className:"pll-metabox-location",children:t})}),k=({postType:t})=>"wp_template"===t?(0,o.jsx)("div",{className:"pll-metabox-error components-notice is-warning",children:(0,p.__)("Templates are not translatable, only template parts are.","polylang-pro")}):(0,o.jsx)("div",{className:"pll-metabox-error components-notice is-warning",children:(0,p.__)("This entity is not translatable.","polylang-pro")}),O=({isError:t,isAllowedPostType:e,postType:n,children:s})=>e?t?(0,o.jsx)(L,{children:(0,o.jsx)("div",{className:"pll-metabox-error components-notice is-error",children:(0,p.__)("Unable to retrieve the content language","polylang-pro")})}):(0,o.jsx)(L,{children:s}):(0,o.jsx)(L,{children:(0,o.jsx)(k,{postType:n})}),A=({children:t})=>(0,o.jsx)("td",{className:"pll-edit-column pll-column-icon",children:t}),R=({language:t})=>(0,o.jsx)("th",{className:"pll-language-column",children:(0,b.isEmpty)(t.flag)?(0,o.jsxs)("abbr",{children:[t.slug,(0,o.jsx)("span",{className:"screen-reader-text",children:t.name})]}):(0,o.jsx)("span",{className:"pll-select-flag flag",children:(0,o.jsx)("img",{src:t.flag_url,alt:t.name,title:t.name})})}),U=({children:t})=>(0,o.jsx)("td",{className:"pll-sync-column pll-column-icon",children:t}),D=({children:t})=>(0,o.jsx)("td",{className:"pll-translation-column",children:t}),M=({language:t,href:e,handleAddClick:n=null})=>{const s=(0,p.sprintf)((0,p.__)("Add a translation in %s","polylang-pro"),t.name);return(0,o.jsx)(u.Button,{href:e,icon:a,label:s,className:"pll-button",onClick:n,"data-target-language":t.slug,children:(0,o.jsx)("span",{className:"screen-reader-text",children:s})})},F=({id:t,postType:e,userPreferenceName:n,activeLabel:s,inactiveLabel:r,icon:i})=>{const a=(0,g.useSelect)((t=>t(j).getCurrentUser()),[]),[l,c]=(0,y.useState)((()=>void 0!==a&&void 0!==a[n]&&void 0!==a[n][e]&&a[n][e])),p=l?s:r;return(0,o.jsx)(u.Button,{id:t,className:`pll-button pll-before-post-translations-button ${l&&"wp-ui-text-highlight"}`,onClick:()=>{(void 0===a[n]||Array.isArray(a[n])&&0===a[n].length)&&(a[n]={}),a[n][e]=!l;const t={};t[n]=a[n],(0,g.dispatch)(j).setCurrentUser(t,!0),c((t=>!t))},icon:i,label:p,children:(0,o.jsx)("span",{className:"screen-reader-text",children:p})})},I=t=>{const{path_d:e,...n}=t.icon,r={type:"svg",props:{...n,children:(0,o.jsx)(s.Path,{d:e})}},i={...t,id:"pll-machine-translation",userPreferenceName:`pll_machine_translation_${t.slug}`,activeLabel:(0,p.sprintf)((0,p.__)("Deactivate %s machine translation","polylang-pro"),t.name),inactiveLabel:(0,p.sprintf)((0,p.__)("Activate %s machine translation","polylang-pro"),t.name),icon:r};return(0,o.jsx)(F,{...i})},z=t=>{const e={...t,id:"pll-duplicate",userPreferenceName:"pll_duplicate_content",activeLabel:(0,p.__)("Deactivate the content duplication","polylang-pro"),inactiveLabel:(0,p.__)("Activate the content duplication","polylang-pro"),icon:r};return(0,o.jsx)(F,{...e})},B=({language:t,href:e,handleEditClick:n=null})=>{const s=(0,p.sprintf)((0,p.__)("Edit the translation in %s","polylang-pro"),t.name);return(0,o.jsx)(u.Button,{href:e,icon:i,label:s,className:"pll-button",onClick:n,"data-target-language":t.slug,children:(0,o.jsx)("span",{className:"screen-reader-text",children:s})})},V=()=>new Promise((function(t){const e=(0,g.subscribe)((function(){const n=(0,g.select)(j)?.getLanguages();n?.size>0&&(e(),t())}))}));function W(){const t=function(){if(!(0,b.isEmpty)(window.location.search))return new URLSearchParams(window.location.search);return null}();null!==t&&(0,g.dispatch)(j).setFromPost({id:wp.sanitize.stripTagsAndEncodeText(t.get("from_post")),postType:wp.sanitize.stripTagsAndEncodeText(t.get("post_type")),newLanguage:wp.sanitize.stripTagsAndEncodeText(t.get("new_lang"))})}const $=()=>{const t=(()=>{const t=(0,g.select)(E);if(!t)return null;const e={postId:t.getEditedPostId(),postType:t.getEditedPostType()};if(t.hasOwnProperty("getEditedPostContext")){const n=t.getEditedPostContext();return n?.postType&&n?.postId?n:e}return e})();return null===t?null:(0,g.select)(C).getEntityRecord("postType",t.postType,t.postId)};function H(t){const e={};return t.forEach((function(t,e){this[e]=(0,b.isBoolean)(t)?t.toString():t}),e),e}function G(){const t=(0,g.select)(j).getLanguages();return Array.from(t.values()).find((t=>t.is_default))}function K(t,e,n){const s=Q(e),o=(0,g.select)(j).getFromPost();let r=new Map(Object.entries([]));return(0,b.isUndefined)(t)||(r=new Map(Object.entries(t))),(0,b.isNil)(o)||(0,b.isNil)(o.id)||s.forEach(((t,e)=>{(0,b.isNil)(t.translated_post)||(0,b.isNil)(t.translated_post.id)||r.set(e,t.translated_post.id)})),r}function q(t){let e=new Map(Object.entries([]));return(0,b.isUndefined)(t)||(e=new Map(Object.entries(t))),e}function Q(t){let e=new Map(Object.entries([]));return(0,b.isUndefined)(t)||(e=new Map(Object.entries(t))),e}function Y(t,e){const n=(0,v.hasQueryArg)(t.path,"lang");((0,b.isUndefined)(t.filterLang)||t.filterLang)&&!n&&(t.path=(0,v.addQueryArgs)(t.path,{lang:e}))}function X(t){const e=new URL(document.location).searchParams,n=e.get("postType"),s=e.get("postId"),o=(0,g.select)("core/edit-post")?.isEditingTemplate();("wp_template_part"===n&&!(0,b.isNil)(s)||o)&&function(t){t.path=(0,v.addQueryArgs)(t.path,{include_untranslated:!0})}(t)}function J(){return document.getElementById("site-editor")||document.getElementById("edit-site-editor")?(0,g.select)(E).getEditedPostType():(0,g.select)(S).getCurrentPostType()}var Z=n(897);class tt extends y.Component{constructor(){super(...arguments),this.confirmButton=(0,y.createRef)()}componentDidMount(){this.confirmButton.current.focus()}render(){const{idPrefix:t,title:e,updateState:n,handleChange:s,children:r}=this.props;return(0,o.jsxs)(u.Modal,{title:e,className:"confirmBox",onRequestClose:n,shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,focusOnMount:!1,children:[r,(0,o.jsxs)(u.ButtonGroup,{className:"buttons",children:[(0,o.jsx)(u.Button,{id:`${t}_confirm`,ref:this.confirmButton,isPrimary:!0,onClick:t=>{s(t),n()},children:(0,p.__)("OK","polylang-pro")}),(0,o.jsx)(u.Button,{id:`${t}_cancel`,isSecondary:!0,onClick:()=>n(),children:(0,p.__)("Cancel","polylang-pro")})]})]})}}const et=function(t,e,n){return(0,Z.createHigherOrderComponent)((s=>{class r extends y.Component{constructor(){super(...arguments),this.state={isOpen:!1,changeValue:null},this.handleChange=this.handleChange.bind(this)}handleChange(t){let e=s.getChangeValue(t);const o=this.props.currentPost;(0,b.isNil)(o)||(e={templateId:e,currentPost:o}),!(0,b.isUndefined)(s.bypassConfirmation)&&s.bypassConfirmation(this.props.translationData)?n(e):this.setState({isOpen:!0,changeValue:e})}render(){const r=this.props.translationData?.lang.is_default,i=this.props,a=Object.assign({},{...i},{handleChange:this.handleChange});return(0,o.jsxs)(y.Fragment,{children:[(0,o.jsx)(s,{...a}),this.state.isOpen&&(0,o.jsx)(tt,{title:s.labelConfirmationModal,idPrefix:t,handleChange:()=>n(this.state.changeValue),updateState:()=>this.setState({isOpen:!1,changeValue:null}),children:(0,o.jsx)(e,{...(0,b.isNil)(r)?{}:{isDefaultLang:r}})})]})}}return r.bypassConfirmation=s.bypassConfirmation,r.getChangeValue=s.getChangeValue,r}),"withConfirmation")};class nt extends y.Component{static handleSynchronizationChange(t){const e=q((0,g.select)(S).getEditedPostAttribute("pll_sync_post"));e.has(t)?e.delete(t):e.set(t,!0),(0,g.dispatch)(S).editPost({pll_sync_post:H(e)}),(0,g.dispatch)(S).editPost({title:(0,g.select)(S).getEditedPostAttribute("title")})}static bypassConfirmation(t){const e=q((0,g.select)(S).getEditedPostAttribute("pll_sync_post")),n=!(0,b.isEmpty)(e)&&e.has(t.lang.slug),s=!(0,b.isUndefined)(t.translated_post)&&!(0,b.isNil)(t.translated_post.id);return n||!s}static getChangeValue(t){return t.currentTarget.id.match(/\[(.[^[]+)\]/i)[1]}render(){const t=q((0,g.select)(S).getEditedPostAttribute("pll_sync_post")),e=this.props.translationData,n=!(0,b.isEmpty)(t)&&t.has(e.lang.slug),s=n&&"wp-ui-text-highlight",r=n?(0,p.__)("Don't synchronize this post","polylang-pro"):(0,p.__)("Synchronize this post","polylang-pro");return(0,o.jsx)(u.Button,{icon:l,label:r,id:`pll_sync_post[${e.lang.slug}]`,className:`pll-button ${s}`,onClick:t=>{this.props.handleChange(t)},children:(0,o.jsx)("span",{className:"screen-reader-text",children:r})})}}nt.labelConfirmationModal=(0,p.__)("Synchronize this post","polylang-pro");const st=et("pll_sync_post",(function(){return(0,o.jsx)("p",{children:(0,p.__)("You are about to overwrite an existing translation. Are you sure you want to proceed?","polylang-pro")})}),nt.handleSynchronizationChange)(nt);var ot=n(942),rt=n.n(ot);function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function at(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function ct(t,e){var n=t["page".concat(e?"Y":"X","Offset")],s="scroll".concat(e?"Top":"Left");if("number"!=typeof n){var o=t.document;"number"!=typeof(n=o.documentElement[s])&&(n=o.body[s])}return n}function ut(t){return ct(t)}function pt(t){return ct(t,!0)}function dt(t){var e=function(t){var e,n,s,o=t.ownerDocument,r=o.body,i=o&&o.documentElement;return n=(e=t.getBoundingClientRect()).left,s=e.top,{left:n-=i.clientLeft||r.clientLeft||0,top:s-=i.clientTop||r.clientTop||0}}(t),n=t.ownerDocument,s=n.defaultView||n.parentWindow;return e.left+=ut(s),e.top+=pt(s),e}var gt,ht=new RegExp("^(".concat(/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,")(?!px)[a-z%]+$"),"i"),ft=/^(top|right|bottom|left)$/,mt="currentStyle",_t="runtimeStyle",yt="left";function vt(t,e){for(var n=0;n<t.length;n++)e(t[n])}function bt(t){return"border-box"===gt(t,"boxSizing")}"undefined"!=typeof window&&(gt=window.getComputedStyle?function(t,e,n){var s="",o=t.ownerDocument,r=n||o.defaultView.getComputedStyle(t,null);return r&&(s=r.getPropertyValue(e)||r[e]),s}:function(t,e){var n=t[mt]&&t[mt][e];if(ht.test(n)&&!ft.test(e)){var s=t.style,o=s[yt],r=t[_t][yt];t[_t][yt]=t[mt][yt],s[yt]="fontSize"===e?"1em":n||0,n=s.pixelLeft+"px",s[yt]=o,t[_t][yt]=r}return""===n?"auto":n});var wt=["margin","border","padding"];function xt(t,e,n){var s,o,r,i=0;for(o=0;o<e.length;o++)if(s=e[o])for(r=0;r<n.length;r++){var a=void 0;a="border"===s?"".concat(s+n[r],"Width"):s+n[r],i+=parseFloat(gt(t,a))||0}return i}function Pt(t){return null!=t&&t==t.window}var jt={};function St(t,e,n){if(Pt(t))return"width"===e?jt.viewportWidth(t):jt.viewportHeight(t);if(9===t.nodeType)return"width"===e?jt.docWidth(t):jt.docHeight(t);var s="width"===e?["Left","Right"]:["Top","Bottom"],o="width"===e?t.offsetWidth:t.offsetHeight,r=(gt(t),bt(t)),i=0;(null==o||o<=0)&&(o=void 0,(null==(i=gt(t,e))||Number(i)<0)&&(i=t.style[e]||0),i=parseFloat(i)||0),void 0===n&&(n=r?1:-1);var a=void 0!==o||r,l=o||i;if(-1===n)return a?l-xt(t,["border","padding"],s):i;if(a){var c=2===n?-xt(t,["border"],s):xt(t,["margin"],s);return l+(1===n?0:c)}return i+xt(t,wt.slice(n),s)}vt(["Width","Height"],(function(t){jt["doc".concat(t)]=function(e){var n=e.document;return Math.max(n.documentElement["scroll".concat(t)],n.body["scroll".concat(t)],jt["viewport".concat(t)](n))},jt["viewport".concat(t)]=function(e){var n="client".concat(t),s=e.document,o=s.body,r=s.documentElement[n];return"CSS1Compat"===s.compatMode&&r||o&&o[n]||r}}));var Et={position:"absolute",visibility:"hidden",display:"block"};function Ct(t){var e,n=arguments;return 0!==t.offsetWidth?e=St.apply(void 0,n):function(t,e,n){var s,o={},r=t.style;for(s in e)e.hasOwnProperty(s)&&(o[s]=r[s],r[s]=e[s]);for(s in n.call(t),e)e.hasOwnProperty(s)&&(r[s]=o[s])}(t,Et,(function(){e=St.apply(void 0,n)})),e}function Tt(t,e,n){var s=n;if("object"!==it(e))return void 0!==s?("number"==typeof s&&(s+="px"),void(t.style[e]=s)):gt(t,e);for(var o in e)e.hasOwnProperty(o)&&Tt(t,o,e[o])}vt(["width","height"],(function(t){var e=t.charAt(0).toUpperCase()+t.slice(1);jt["outer".concat(e)]=function(e,n){return e&&Ct(e,t,n?0:1)};var n="width"===t?["Left","Right"]:["Top","Bottom"];jt[t]=function(e,s){if(void 0===s)return e&&Ct(e,t,-1);if(e){gt(e);return bt(e)&&(s+=xt(e,["padding","border"],n)),Tt(e,t,s)}}}));var Nt=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lt(n,!0).forEach((function(e){at(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({getWindow:function(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow},offset:function(t,e){if(void 0===e)return dt(t);!function(t,e){"static"===Tt(t,"position")&&(t.style.position="relative");var n,s,o=dt(t),r={};for(s in e)e.hasOwnProperty(s)&&(n=parseFloat(Tt(t,s))||0,r[s]=n+e[s]-o[s]);Tt(t,r)}(t,e)},isWindow:Pt,each:vt,css:Tt,clone:function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);if(t.overflow)for(var s in t)t.hasOwnProperty(s)&&(e.overflow[s]=t.overflow[s]);return e},scrollLeft:function(t,e){if(Pt(t)){if(void 0===e)return ut(t);window.scrollTo(e,pt(t))}else{if(void 0===e)return t.scrollLeft;t.scrollLeft=e}},scrollTop:function(t,e){if(Pt(t)){if(void 0===e)return pt(t);window.scrollTo(ut(t),e)}else{if(void 0===e)return t.scrollTop;t.scrollTop=e}},viewportWidth:0,viewportHeight:0},jt);const Lt=function(t,e,n){n=n||{},9===e.nodeType&&(e=Nt.getWindow(e));var s=n.allowHorizontalScroll,o=n.onlyScrollIfNeeded,r=n.alignWithTop,i=n.alignWithLeft,a=n.offsetTop||0,l=n.offsetLeft||0,c=n.offsetBottom||0,u=n.offsetRight||0;s=void 0===s||s;var p,d,g,h,f,m,_,y,v,b,w=Nt.isWindow(e),x=Nt.offset(t),P=Nt.outerHeight(t),j=Nt.outerWidth(t);w?(_=e,b=Nt.height(_),v=Nt.width(_),y={left:Nt.scrollLeft(_),top:Nt.scrollTop(_)},f={left:x.left-y.left-l,top:x.top-y.top-a},m={left:x.left+j-(y.left+v)+u,top:x.top+P-(y.top+b)+c},h=y):(p=Nt.offset(e),d=e.clientHeight,g=e.clientWidth,h={left:e.scrollLeft,top:e.scrollTop},f={left:x.left-(p.left+(parseFloat(Nt.css(e,"borderLeftWidth"))||0))-l,top:x.top-(p.top+(parseFloat(Nt.css(e,"borderTopWidth"))||0))-a},m={left:x.left+j-(p.left+g+(parseFloat(Nt.css(e,"borderRightWidth"))||0))+u,top:x.top+P-(p.top+d+(parseFloat(Nt.css(e,"borderBottomWidth"))||0))+c}),f.top<0||m.top>0?!0===r?Nt.scrollTop(e,h.top+f.top):!1===r?Nt.scrollTop(e,h.top+m.top):f.top<0?Nt.scrollTop(e,h.top+f.top):Nt.scrollTop(e,h.top+m.top):o||((r=void 0===r||!!r)?Nt.scrollTop(e,h.top+f.top):Nt.scrollTop(e,h.top+m.top)),s&&(f.left<0||m.left>0?!0===i?Nt.scrollLeft(e,h.left+f.left):!1===i?Nt.scrollLeft(e,h.left+m.left):f.left<0?Nt.scrollLeft(e,h.left+f.left):Nt.scrollLeft(e,h.left+m.left):o||((i=void 0===i||!!i)?Nt.scrollLeft(e,h.left+f.left):Nt.scrollLeft(e,h.left+m.left)))};var kt=n(860),Ot=n(631),At=n.n(Ot);const Rt=({value:t,post:e=null,translatedPosts:n,translationData:s,language:o})=>{(0,b.isEmpty)(e)?(s.translated_post={id:null,title:t},s.links={add_link:s.links.add_link},n.delete(o.slug)):(n.set(o.slug,e.id),s.translated_post={id:e.id,title:e.title.raw},s.block_editor={edit_link:e.block_editor.edit_link},s.caps=e.caps),(0,g.dispatch)(S).editPost({translations:H(n)}),(0,g.dispatch)(S).editPost({title:(0,g.select)(S).getEditedPostAttribute("title")})},Ut=t=>t.stopPropagation();class Dt extends y.Component{constructor(){super(...arguments),this.onChange=this.onChange.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.bindListNode=this.bindListNode.bind(this),this.updateSuggestions=(0,b.debounce)(this.updateSuggestions.bind(this),500),this.suggestionNodes=[],this.state={posts:[],showSuggestions:!1,selectedSuggestion:null}}componentDidUpdate(){const{showSuggestions:t,selectedSuggestion:e}=this.state;t&&null!==e&&!this.scrollingIntoView&&(this.scrollingIntoView=!0,Lt(this.suggestionNodes[e],this.listNode,{onlyScrollIfNeeded:!0}),setTimeout((()=>{this.scrollingIntoView=!1}),100))}componentWillUnmount(){delete this.suggestionsRequest}bindListNode(t){this.listNode=t}bindSuggestionNode(t){return e=>{this.suggestionNodes[t]=e}}updateSuggestions(t,e=!1){if(t.length<2&&!e)return void this.setState({showSuggestions:!1,selectedSuggestion:null,loading:!1});this.setState({selectedSuggestion:null,loading:!0});const n=(0,g.select)(S).getCurrentPostId(),s=(0,g.select)(S).getCurrentPostType(),o=(0,g.select)(S).getEditedPostAttribute("lang"),r=this.props.translationData.lang.slug,i=At()({path:(0,v.addQueryArgs)("/pll/v1/untranslated-posts",{search:t,include:n,untranslated_in:o,lang:r,type:s,context:"edit"})});i.then((t=>{this.suggestionsRequest===i&&(this.setState({posts:t,showSuggestions:!0,loading:!1}),t.length?this.props.debouncedSpeak((0,p.sprintf)((0,p._n)("%d result found, use up and down arrow keys to navigate.","%d results found, use up and down arrow keys to navigate.",t.length,"polylang-pro"),t.length),"assertive"):this.props.debouncedSpeak((0,p.__)("No results.","polylang-pro"),"assertive"))})).catch((()=>{this.suggestionsRequest===i&&this.setState({loading:!1})})),this.suggestionsRequest=i}onChange(t){const e=t.target.value,n=this.props.translatedPosts,s=this.props.translationData,o=this.props.translationData.lang;Rt({value:e,translatedPosts:n,translationData:s,language:o}),this.updateSuggestions(e)}onKeyDown(t){const{showSuggestions:e,selectedSuggestion:n,posts:s,loading:o}=this.state;let r=t.target.value,i=!1;if(e&&s.length&&!o)switch(t.keyCode){case kt.UP:{t.stopPropagation(),t.preventDefault();const e=n?n-1:s.length-1;this.setState({selectedSuggestion:e});break}case kt.DOWN:{t.stopPropagation(),t.preventDefault();const e=null===n||n===s.length-1?0:n+1;this.setState({selectedSuggestion:e});break}case kt.ENTER:if(null!==this.state.selectedSuggestion){t.stopPropagation();const e=this.state.posts[this.state.selectedSuggestion];this.selectLink(e)}break;case kt.ESCAPE:t.stopPropagation(),this.setState({selectedSuggestion:null,showSuggestions:!1})}else{switch(t.keyCode){case kt.SPACE:const{ctrlKey:e,shiftKey:n,altKey:s,metaKey:o}=t;e&&!(n||s||o)&&(r="",i=!0);break;case kt.BACKSPACE:(0,b.isEmpty)(r)&&(i=!0)}i&&this.updateSuggestions(r,!0)}}selectLink(t){const e=this.props.translationData,n=this.props.translatedPosts,s=this.props.translationData.lang;Rt({value:t.title.raw,post:t,translatedPosts:n,translationData:e,language:s}),this.setState({selectedSuggestion:null,showSuggestions:!1})}render(){const{value:t="",autoFocus:e=!0,instanceId:n,translationData:s}=this.props,r=s.lang,{showSuggestions:i,posts:a,selectedSuggestion:l,loading:c}=this.state,d=s.caps.edit||s.caps.add;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("label",{className:"screen-reader-text",htmlFor:`tr_lang_${s.lang.slug}`,children:(0,p.__)("Translation","polylang-pro")}),(0,o.jsxs)("div",{className:"translation-input",children:[(0,o.jsx)("input",{lang:r.w3c,dir:r.is_rtl?"rtl":"ltr",style:{direction:r.is_rtl?"rtl":"ltr"},autoFocus:e,disabled:!d,type:"text","aria-label":(0,p.__)("URL","polylang-pro"),required:!0,value:t,onChange:this.onChange,onInput:Ut,placeholder:(0,p.__)("Start typing the post title","polylang-pro"),onKeyDown:this.onKeyDown,role:"combobox","aria-expanded":i,"aria-autocomplete":"list","aria-owns":`translation-input-suggestions-${n}`,"aria-activedescendant":null!==l?`translation-input-suggestion-${n}-${l}`:void 0}),c&&(0,o.jsx)(u.Spinner,{})]}),i&&!!a.length&&(0,o.jsx)(u.Popover,{position:"bottom",noArrow:!0,focusOnMount:!1,children:(0,o.jsx)("div",{className:"translation-input__suggestions",id:`translation-input-suggestions-${n}`,ref:this.bindListNode,role:"listbox",children:a.map(((t,e)=>(0,o.jsx)("button",{role:"option",tabIndex:"-1",id:`translation-input-suggestion-${n}-${e}`,ref:this.bindSuggestionNode(e),className:rt()("translation-input__suggestion",{"is-selected":e===l}),onClick:()=>this.selectLink(t),"aria-selected":e===l,children:t.title.raw||(0,p.__)("(no title)","polylang-pro")},t.id)))})})]})}}const Mt=(0,u.withSpokenMessages)((0,Z.withInstanceId)(Dt)),Ft=({language:t,children:e})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(R,{language:t}),e]}),It=({children:t})=>(0,o.jsxs)("div",{id:"post-translations",className:"translations",children:[(0,o.jsx)("p",{children:(0,o.jsx)("strong",{children:(0,p.__)("Translations","polylang-pro")})}),(0,o.jsx)("table",{children:(0,o.jsx)("tbody",{children:t})})]}),zt=({selectedLanguage:t,translationsTable:e})=>{const n=K((0,g.select)(S).getEditedPostAttribute("translations"),e,t.slug),s=Array.from(e.values()).map((e=>{if(t.slug===e.lang.slug)return null;const s=void 0!==e.translated_post?.id&&null!==e.translated_post?.id,r=e.caps.edit,i=e.caps.add;return(0,o.jsx)("tr",{children:(0,o.jsxs)(Ft,{language:e.lang,children:[(0,o.jsx)(A,{children:s&&r?(0,o.jsx)(B,{href:decodeURI(e.block_editor.edit_link),language:e.lang}):i?(0,o.jsx)(M,{href:decodeURI(e.links.add_link),language:e.lang}):null}),(0,o.jsx)(U,{children:e.can_synchronize&&(0,o.jsx)(st,{translationData:e})}),(0,o.jsx)(D,{children:(0,o.jsx)(Mt,{id:`htr_lang_${e.lang.slug}`,autoFocus:!1,translatedPosts:n,translationData:e,value:void 0!==e.translated_post?.title?e.translated_post?.title:""})})]})},e.lang.slug)}));return(0,o.jsx)(It,{children:s})};n(488);const Bt=()=>{const t=(0,g.select)(S);return!t.getEditedPostAttribute("title")&&!t.getEditedPostContent()&&!t.getEditedPostAttribute("excerpt")},Vt=t=>{const e=(0,g.select)(S);return Bt()?At()({path:(0,v.addQueryArgs)(`wp/v2/posts/${e.getCurrentPostId()}`,{lang:t}),method:"POST"}):Promise.reject("Force save not required.")},Wt=({tableDispatch:t})=>{const{createSuccessNotice:e,createErrorNotice:n}=(0,g.useDispatch)(h.store),s=(0,g.select)(j).getLanguages(),r=s.get((0,g.select)(S).getEditedPostAttribute("lang")),[i,a]=(0,y.useState)(!1),[l,c]=(0,y.useState)(r),d=(0,y.useRef)(l);(0,y.useEffect)((()=>{d.current=r}),[r]);const f=()=>a(!1),m=s=>{if(f(),!s)return void n((0,p.__)("Failed to save selected language","polylang-pro"),{type:"snackbar"});const o=(t=>{const e=(0,g.select)(S).getEditedPostAttribute("lang"),n=(0,g.select)(S).getCurrentPostId(),s=(0,g.select)(j).getLanguages().get(e),o=q((0,g.select)(S).getEditedPostAttribute("pll_sync_post")),r=(0,g.select)(S).getEditedPostAttribute("translations_table"),i=K((0,g.select)(S).getEditedPostAttribute("translations"),r,s.slug),a=Q(r,s.slug);i.delete(s.slug),i.set(t.slug,n),o.delete(s.slug);const l=a.get(s.slug);a.set(s.slug,{can_synchronize:l.can_synchronize,lang:l.lang,links:{add_link:l.links.add_link},caps:l.caps,site_editor:l.site_editor,block_editor:l.block_editor});const c=a.get(t.slug);return a.set(t.slug,{can_synchronize:c.can_synchronize,lang:c.lang,links:c.links,translated_post:l.translated_post,caps:c.caps,site_editor:c.site_editor,block_editor:c.block_editor}),pll_block_editor_plugin_settings.lang=t,{lang:t.slug,pll_sync_post:H(o),translations:H(i),translations_table:H(a)}})(s);((t,e)=>Promise.allSettled([(0,g.dispatch)(S).editPost(e),(0,g.dispatch)(S).savePost(),Vt(t.slug)]).then((()=>{(0,g.dispatch)(C).invalidateResolutionForStore()})))(s,o).then((()=>{t({type:"set_table",table:Q(o.translations_table)}),e((0,p.__)("Language changed","polylang-pro"),{type:"snackbar"}),document.dispatchEvent(new CustomEvent("onPostLangChoice",{detail:{lang:s}}))}))},_=()=>{c(d.current),f()};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("p",{children:(0,o.jsx)("strong",{children:(0,p.__)("Language","polylang-pro")})}),(0,o.jsx)("label",{className:"screen-reader-text",htmlFor:"pll_post_lang_choice",children:(0,p.__)("Language","polylang-pro")}),(0,o.jsx)(x,{selectedLanguage:l,handleChange:t=>{c(s.get(t.target.value)),Bt()?m(s.get(t.target.value)):a(!0)},children:(0,o.jsx)(P,{languages:s})}),i&&(0,o.jsxs)(u.Modal,{title:(0,p.__)("Change language","polylang-pro"),onRequestClose:_,children:[(0,o.jsx)("p",{children:(0,p.__)("Are you sure you want to change the language of the current content?","polylang-pro")}),(0,o.jsxs)("div",{role:"group",className:"components-button-group buttons",children:[(0,o.jsx)(u.Button,{variant:"tertiary",onClick:_,type:"button",children:(0,p.__)("Cancel","polylang-pro")}),(0,o.jsx)("span",{children:"Â "}),(0,o.jsx)(u.Button,{variant:"primary",onClick:()=>m(l),type:"submit",children:(0,p.__)("Change","polylang-pro")})]})]})]})},$t=(t,e)=>{switch(e.type){case"remove_translation":return delete t.get(e.lang).translated_post,new Map(t);case"set_table":return e.table;default:return t}},Ht=()=>{const[t,e]=(0,y.useReducer)($t,new Map),{currentPost:n,currentPostType:s,selectedLanguage:r,isAllowedPostType:i}=(0,g.useSelect)((t=>{const n=t(S).getCurrentPost(),s=t(S).getCurrentPostType(),o=t(S).getEditedPostAttribute("lang"),r=t(S).getEditedPostAttribute("translations_table"),i=!N.includes(n?.type),a=function(t){const e=(0,g.select)(j).getLanguages();return e?e.get(t):null}(o),l=Q(r);return e({type:"set_table",table:l}),{currentPost:n,currentPostType:s,selectedLanguage:a,isAllowedPostType:i}}),[e]),a=pll_block_editor_plugin_settings?.machine_translation;return(0,o.jsxs)(O,{isError:!r,isAllowedPostType:i,postType:n?.type,children:[(0,o.jsx)(Wt,{tableDispatch:e}),(0,o.jsx)(z,{postType:s}),a?.isActive&&(0,o.jsx)(I,{postType:s,slug:a.slug,name:a.name,icon:a.icon}),(0,o.jsx)(zt,{translationsTable:t,selectedLanguage:r})]})},Gt={setLanguages:t=>({type:"SET_LANGUAGES",languages:t}),setCurrentUser:(t,e=!1)=>({type:"SET_CURRENT_USER",currentUser:t,save:e}),setFromPost:t=>({type:"SET_FROM_POST",fromPost:t}),fetchFromAPI:t=>({type:"FETCH_FROM_API",options:t})},Kt=(0,g.createReduxStore)(j,{reducer(t=T,e){switch(e.type){case"SET_LANGUAGES":return{...t,languages:e.languages};case"SET_CURRENT_USER":return e.save&&(n=e.currentUser,Promise.resolve(At()({path:"/wp/v2/users/me",data:n,method:"POST"}))).then((n=>(e.currentUser=n,{...t,currentUser:e.currentUser}))),{...t,currentUser:e.currentUser};case"SET_FROM_POST":return{...t,fromPost:e.fromPost};case"SET_CURRENT_TEMPLATE_PART":return{...t,currentTemplatePart:e.currentTemplatePart};default:return t}var n},selectors:{getLanguages:t=>t.languages,getCurrentUser:t=>t.currentUser,getFromPost:t=>t.fromPost},actions:Gt,controls:{FETCH_FROM_API:t=>At()({...t.options})},resolvers:{*getLanguages(){const t=yield Gt.fetchFromAPI({path:"/pll/v1/languages",filterLang:!1});return Gt.setLanguages(function(t,e){const n=new Map;return t.reduce((function(t,n){return t.set(n[e],n),t}),n),n}(t,"slug"))},*getCurrentUser(){const t=yield Gt.fetchFromAPI({path:"/wp/v2/users/me",filterLang:!0});return Gt.setCurrentUser(t)}}});(0,g.register)(Kt);const qt=(t,e,n)=>{const s=t.path.split("?")[0].replace(/^\/+|\/+$/g,"");return Object.values(e).find((t=>s===t))?n(t):t};(t=>{At().use(((e,n)=>void 0!==e.url||"undefined"==typeof pllFilteredRoutes?n(e):n(qt(e,pllFilteredRoutes,t))))})((function(t){const e=function(){if((0,b.isUndefined)((0,g.select)(S)))return pll_block_editor_plugin_settings.lang.slug;const t=(0,g.select)(S).getEditedPostAttribute("lang");if(!(0,b.isUndefined)(t)&&t)return t;const e=new URL(document.location).searchParams,n=e.get("postType"),s=e.get("postId");if("wp_template_part"===n&&(0,b.isNil)(s))return pll_block_editor_plugin_settings.lang=G(),pll_block_editor_plugin_settings.lang.slug;const o=$(),r=o?.lang;if(!(0,b.isUndefined)(r)&&r)return r;return pll_block_editor_plugin_settings.lang.slug}();return function(t){return!(0,b.isNil)(t.data)}(t)?(function(t){return"POST"===t.method&&t.path.match(/^\/wp\/v2\/template-parts(?:\/|\?|$)/)&&(0,b.isNil)(t.data.from_post)&&(0,b.isNil)(t.data.lang)}(t)&&Y(t,G()?.slug),function(t){const e=(0,b.map)((0,g.select)("core").getEntitiesConfig("postType"),(0,b.property)("baseURL")),n=(0,g.select)("core/editor").getCurrentPostId(),s=t.data.id;return-1!==e.findIndex((function(e){return new RegExp(`${(0,b.escapeRegExp)(e)}`).test(t.path)}))&&n===s}(t)||function(t){return"POST"===t.method&&t.path.match(/^\/wp\/v2\/template-parts(?:\/|\?|$)/)&&!(0,b.isNil)(t.data.from_post)&&!(0,b.isNil)(t.data.lang)}(t)||Y(t,e),function(t,e){const n=function(t){const e=(0,g.select)("core").getEntitiesConfig("postType"),n=(0,b.find)(e,{name:t});return n?.baseURL}("wp_template_part");if((0,b.isUndefined)(n))return;const s=new RegExp((0,b.escapeRegExp)(n));if("POST"===t.method&&s.test(t.path)){if(!(0,g.select)(j).getLanguages().get(e).is_default){const n="___"+e;t.data.slug+=n}}}(t,e),t):("wp_template"===J()&&Y(t,G()?.slug),new RegExp(/^\/wp\/v2\/template-parts\/?(?:\?.*)?$/).test(t.path)&&X(t),Y(t,e),t)}));const Qt="polylang-sidebar",Yt=pll_block_editor_plugin_settings?.machine_translation?.errors;(t=>{const e=document.createElement("div");e.id="pll-root";const n=document.body.appendChild(e);y.createRoot?(0,y.createRoot)(n).render(t):(0,y.render)(t,n)})((0,o.jsx)(d,{sidebar:()=>(0,o.jsx)(_,{SidebarSlot:t.PluginSidebar,MoreMenuItemSlot:t.PluginSidebarMoreMenuItem,sidebarName:Qt,children:(0,o.jsx)(Ht,{})}),sidebarName:Qt,onPromise:()=>{if((0,b.isNil)((0,g.select)(S)))return Promise.reject("Polylang languages panel can't be initialized because block editor isn't fully initialized.");W(),(0,g.select)(j).getCurrentUser();const t=new Promise((function(t){const e=(0,g.subscribe)((function(){const n=(0,g.select)(S).getCurrentPost();(0,b.isEmpty)(n)||(e(),t())}))}));return Promise.all([t,V()]).then((function(){const t=(0,g.select)(j).getFromPost();if(!(0,b.isNil)(t)&&!(0,b.isNil)(t.id)){const t=(0,g.select)(S).getEditedPostAttribute("lang"),e=K((0,g.select)(S).getEditedPostAttribute("translations"),(0,g.select)(S).getEditedPostAttribute("translations_table"),t);(0,g.dispatch)(S).editPost({translations:H(e)})}}))},children:void 0!==Yt&&(0,o.jsx)(m,{notices:Yt})}))})(),this["polylang-pro"]={}})();