(t=>{t("a[data-reveal-id]").live("click",function(o){o.preventDefault();o=t(this).attr("data-reveal-id");t("#"+o).reveal(t(this).data())}),t.widget("ui.reveal",{options:{animation:"fadeAndPop",animationspeed:300,closeonbackgroundclick:!0,closeonesc:!0,dismissmodalclass:"close-reveal-modal",backdrop:!0,autoshow:!0,showevent:"show",shownevent:"shown",hideevent:"hide",hiddenevent:"hidden",draggable:!1,draghandle:null,fixed:!0,topPosition:150},_create:function(){var o,e=this,a=e.options,i=e.modal=e.element.addClass("reveal-modal"),n=e._topMeasure=parseInt(i.css("top")),n=(e._topOffset=i.height()+n,e._locked=!1,e.modalBG=t(".reveal-modal-bg"));i.attr("id")||i.attr("id",(new Date).getTime()+Math.floor(100*Math.random()+1)),e._isOpen=!1,a.draggable&&(o={handle:a.draghandle},i.draggable(o)),0==n.length&&(e.modalBG=t('<div class="reveal-modal-bg" />').insertAfter(i)),t("."+a.dismissmodalclass).off("click.reveal").on("click.reveal",function(){e.close()});a.closeonbackgroundclick&&(e.modalBG.css({cursor:"pointer"}),e.modalBG.off("click.reveal").on("click.reveal",function(){e.close()}))},_init:function(){var o=this,e=o.options;o.modal.on("reveal:open "+e.showevent,function(){o._isOpen||o.open()}),o.modal.on("reveal:close "+e.hideevent,function(){o._isOpen&&o.close()}),e.autoshow&&o.modal.trigger("reveal:open")},open:function(){var o,e=this,a=e.options;t("."+a.dismissmodalclass).off("click.modalEvent"),e._locked||(e.lockModal(),e.modal.css({left:"50%"}),"fadeAndPop"==a.animation&&(o=void 0!==a.scrollheight?a.scrollheight:t(document).scrollTop(),e.modal.css({top:a.fixed?0:o-e._topOffset,opacity:0,visibility:"visible"}),a.backdrop&&e.modalBG.fadeIn(a.animationspeed/2),e.modal.show().delay(a.animationspeed/2).animate({top:a.fixed?a.topPosition:o+e._topMeasure+"px",opacity:1},a.animationspeed,e.shown())),"fade"==a.animation&&(e.modal.css({opacity:0,visibility:"visible",top:t(document).scrollTop()+e._topMeasure}),e.modalBG.fadeIn(a.animationspeed/2),e.modal.show().delay(a.animationspeed/2).animate({opacity:1},a.animationspeed,e.shown())),"none"==a.animation&&(e.modal.css({visibility:"visible",top:t(document).scrollTop()+e._topMeasure}),e.modalBG.show(),e.shown())),a.closeonesc&&t("body").on("keyup.reveal_"+e.modal.attr("id"),function(o){27===o.which&&e.close()}),e.modal.unbind("reveal:open")},close:function(o){var e,a=this,i=a.options;a._locked||(a.lockModal(),"fadeAndPop"==i.animation&&(e=void 0!==i.scrollheight?i.scrollheight:t(document).scrollTop(),i.backdrop&&a.modalBG.delay(i.animationspeed).fadeOut(i.animationspeed),a.modal.animate({top:i.fixed?0:e-a._topOffset+"px",opacity:0},i.animationspeed/2,function(){a.modal.css({top:a._topMeasure,opacity:1,visibility:"hidden"}),a.hidden(o)})),"fade"==i.animation&&(a.modalBG.delay(i.animationspeed).fadeOut(i.animationspeed),a.modal.animate({opacity:0},i.animationspeed,function(){a.modal.css({opacity:1,visibility:"hidden",top:a._topMeasure}),a.hidden(o)})),"none"==i.animation&&(a.modal.css({visibility:"hidden",top:a._topMeasure}),a.modalBG.hide(),a.hidden(o))),t("body").off("keyup.reveal_"+a.modal.attr("id")),a.modal.unbind("reveal:close")},shown:function(){var o=this,e=o.options;o.modal.trigger(e.shownevent),o._isOpen=!0,o.unlockModal()},hidden:function(o){var e=this,a=e.options;e.modal.trigger(a.hiddenevent),e._trigger("close",o),e._isOpen=!1,e.unlockModal()},unlockModal:function(){self._locked=!1},lockModal:function(){self._locked=!0}})})(sQuery);